![meltdown logo](https://raw.githubusercontent.com/Fineas/meltdown_vulnerability/master/img/img1.png)

# MELTDOWN

_Reading Kernel Memory from User Space_

[**CVE identifier**](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures): [CVE](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures_(identifier))-[2017-5754](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5754)

**Date discovered** : January 2018;

**Affected hardware** : Intel x86 microprocessors, IBM POWER processors, and some ARM-based microprocessors



## 1. Background

Let&#39;s assume the following lines of code:

 ![poza2](google.com)

Normally, we would expect the CPU to execute these lines of code one after the other, but that&#39;s not the case. Most modern CPUs will execute these lines of code at the same time. This is what we call: out-of-order execution, which allows the CPU to run much faster by minimizing the idle time. This has been made possible by Robert Tomasulo&#39;s algorithm back in 1967.

 ![poza3](facebook.com)

## 2. Trigger Meltdown

Here is how you can trigger Meltdown.

The attacker will start by trying to read a character at a private address.

 ![poza4](twitter.com)

By looking at this simple memory diagram we can see that from index **A** to index **B** is where the memory stores the data for your program, but beyond or before that, there is data that you don&#39;t have access to and the CPU is in charge to make sure that you don&#39;t have access to this information.

| ... | 0x42 | 0xca | 0xfe | 0xba | ... | 0xbe | 0x41 | 0x41 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

  ...    A-1      A     A+1    A+2     ...     B      B+1    B+2     ...

When the attacker runs this code, the CPU will notice that the program does not have access to index memory 1337 and will throw an exception: segmentation fault (SEGFAULT). Even though the program throws an exception, the calculation has already been made by the CPU. What the researchers have discovered is that even though we don&#39;t have access to that secret memory area, it&#39;s result is saved in the CPU Cache. Now, the only job for an attacker is to guess the value of **secret\_character.**

As a reminder, although the line of code throws an exception, the attacker is able to exploit the concept of out-of-order execution and run a few lines of code at the same time.

So, in this example:

 ![poza6](yahoo.com)

line number 9 is called an **transient instruction** , which is an instruction executed out-of-order leaving major side effects. So the attackers takes advantage of this and write a few lines of code that allows them to guess the value of **secret\_character**. The way they will do it is by using a well known time based attack.

Here&#39;s how it works:

 ![poza7](gmail.com)

The attacker will create a buffer containing all the possible bytes. And then they will prob the array using the value of **secret\_character**. Which means they will access every single element and measure the time it takes to get the result. Let&#39;s say it takes:

 30ms to access dictionary[secret\_character],

 30ms to access dictionary[secret\_character+1],

 ...

 3ms to access dictionary[secret\_character+0x41],

This means **dictionary[secret\_character+0x41]** was already in the CPU cache that&#39;s why it was read much faster. This means that the value of **secret\_character** is 0x41 (&#39;A&#39;). That&#39;s how the attacker was able to guess the value of one secret byte at posiiton B+1.Then they will repeat this for the next value of the input **read\_byte\_at\_index(1338)**, **read\_byte\_at\_index(1339)** and so on. Basically allowing the attacker to read the entire memory on the computer, which is normally protected by the CPU.



## 3. Conclusion

As you can see, Meltdown literally melts down the security boundaries in the CPU. That&#39;s how it got it&#39;s name. It is very powerful because it allows the attacker to access protected memory that belongs to a completly different process.



## 4. Refferences

[1] [https://meltdownattack.com/meltdown.pdf](https://meltdownattack.com/meltdown.pdf)

[2] [https://en.wikipedia.org/wiki/Meltdown\_(security\_vulnerability)](https://en.wikipedia.org/wiki/Meltdown_(security_vulnerability))

[3] [https://www.youtube.com/watch?v=I5mRwzVvFGE](https://www.youtube.com/watch?v=I5mRwzVvFGE)

[4] [https://en.wikipedia.org/wiki/Tomasulo\_algorithm](https://en.wikipedia.org/wiki/Tomasulo_algorithm)

[5] [https://meltdownattack.com/](https://meltdownattack.com/)

































Silaghi Fineas - Florin.
